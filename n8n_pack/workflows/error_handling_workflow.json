{
  "name": "Error Handling & SRE Workflow",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "/webhook/agent-error"
      },
      "id": "error-webhook",
      "name": "Agent Error Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [100, 300]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "url": "={{ $vars.AGENT_BASE_URL }}/agents/technical-reliability-sre",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpBearerAuth",
        "sendBody": true,
        "contentType": "json",
        "jsonBody": "={{ JSON.stringify({\n  signal: 'error_event',\n  context: {\n    error: $json.error,\n    agent: $json.agent,\n    timestamp: new Date().toISOString(),\n    workflow_id: $json.workflow_id\n  }\n}) }}"
      },
      "id": "sre-triage",
      "name": "ðŸ”§ SRE Triage",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [300, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $('sre-triage').item.json.status }}",
              "operation": "equal",
              "value2": "healed"
            }
          ]
        }
      },
      "id": "healing-gate",
      "name": "ðŸ©¹ Healing Gate",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [500, 300]
    },
    {
      "parameters": {
        "message": "âœ… System automatically healed: {{ $('sre-triage').item.json.root_cause }}",
        "options": {}
      },
      "id": "success-notification",
      "name": "âœ… Success Notification",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [700, 200]
    },
    {
      "parameters": {
        "message": "ðŸš¨ Manual intervention required: {{ $('sre-triage').item.json.root_cause }}\\n\\nActions taken: {{ JSON.stringify($('sre-triage').item.json.actions) }}",
        "options": {},
        "subject": "ðŸš¨ Unburden America: Manual Intervention Required"
      },
      "id": "escalation-alert",
      "name": "ðŸš¨ Escalation Alert",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2,
      "position": [700, 400]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "url": "={{ $vars.AGENT_BASE_URL }}/agents/campaign-orchestration",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpBearerAuth",
        "sendBody": true,
        "contentType": "json",
        "jsonBody": "={{ JSON.stringify({\n  request_id: $workflow.id,\n  intent: 'resume_after_heal',\n  payload: {\n    healing_result: $('sre-triage').item.json,\n    original_error: $json\n  }\n}) }}"
      },
      "id": "resume-orchestration",
      "name": "ðŸ”„ Resume Orchestration",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [900, 200]
    }
  ],
  "connections": {
    "Agent Error Webhook": {
      "main": [
        [
          {
            "node": "ðŸ”§ SRE Triage",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ðŸ”§ SRE Triage": {
      "main": [
        [
          {
            "node": "ðŸ©¹ Healing Gate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ðŸ©¹ Healing Gate": {
      "main": [
        [
          {
            "node": "âœ… Success Notification",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ðŸš¨ Escalation Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Success Notification": {
      "main": [
        [
          {
            "node": "ðŸ”„ Resume Orchestration",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {},
  "versionId": "1.0.0",
  "id": "error-handling-workflow"
}
